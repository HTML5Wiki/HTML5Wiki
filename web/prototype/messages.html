<!DOCTYPE html>
<html lang="de">
<head>
	<meta charset="utf-8" />
	<title>Aritkel | HTML5Wiki</title>
	<meta name="description" content="">
 	<meta name="author" content="HTML5Wiki">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="shortcut icon" href="../images/favicon.ico" type="image/x-icon" />
	<link rel="icon" href="../images/favicon.ico" type="image/ico" />
	<link rel="stylesheet" href="../css/html5wiki.css" />
	<!--script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js?ver=1.4.2"></script--> 
	<script type="text/javascript" src="js/jquery-nonproductive.js"></script>
</head> 
<body>
	<header class="header-overall">
		<a href="#" class="logo"><span class="hide">HTML5Wiki</span></a>
		<nav class="main-menu">
			<ol class="menu-items clearfix">
				<li class="item home"><a href="#" class="tab">Startseite</a></li>
				<li class="item updates"><a href="#" class="tab">Neuste Änderungen</a></li>
				<li class="item article active"><a href="#" class="tab">Der erste grosse Artikel im Prototyp</a></li>
				<li class="item search"><input placeholder="Suchen" class="searchterm" accesskey="s" /></li>
			</ol>
		</nav>
	</header>

	<article class="content article">
		<header class="title clearfix">
			<h1 class="heading">Der erste grosse Artikel im Prototyp</h1>
			<ol class="capsulebar">
				<li class="item first active read"><a href="#" class="capsule"><span class="caption">Lesen</span></a></li>
				<li class="item edit"><a href="#" class="capsule"><span class="caption">Bearbeiten</span></a></li>
				<li class="item last history"><a href="#" class="capsule"><span class="caption">&Auml;nderungsgeschichte</span></a></li>
			</ol>
		</header>
		
		<section>
			<p>
				Use links below to see message-prototypes.<br/>
				The question-message will report the clicked button/link into your firebug console.<br/>
				<em>Hint: Click fast to enqueue more than one messagebox into the queue.</em>
			</p>
			<p>
				<a href="#" onclick="showInfoMessage();">Info Message</a></br>
				<a href="#" onclick="showErrorMessage();">Error Message</a></br>
				<a href="#" onclick="showQuestionMessage();">Question</a>
			</p>
		</section>
	</article>
	
	<script type="text/javascript">
		/**
		 * Info-Message-Demo
		 */
		function showInfoMessage() {
			MessageController.addMessage('info','Dies ist eine Informations-Meldung.');
		}
		
		/**
		 * Error-Message-Demo
		 */
		function showErrorMessage() {
			MessageController.addMessage('error','Dies ist eine Fehlermeldung!');
		}
		
		/**
		 * Question-Message-Demo
		 */
		function showQuestionMessage() {
			var options = [
				{
					text : 'Ja'
					,button : true
					,callback : function() { console.log('Coole Sau ;)'); }
				},{
					text : 'Nein, das tu\' ich nicht.'
					,callback : function() { console.log('pf, schade, was?'); }
				}
			];
			MessageController.addMessage('question','Gehörst du zum HTML5Wiki Team?', options);
		}
		
		/**
		 * Handles the creation, management and control of messages for the
		 * GUI in one central place.
		 *
		 * @see MessageController#addMessage(type,message,options)
		 * @author Manuel Alabor
		 */
		var MessageController = (function() {
			var self = {}
				,messageQueue = new Array()
				,message_slidedown_time = 'fast'
				,message_slideup_time = 'fast'
				,overlay_fadein_time = 300
				,overlay_fadeout_time = 200
				,message_show_time = 2000;
			
			/**
			 * Adds a Message with given parameters to the queue and ensures
			 * that the oldest queued message gets displayed.<br/>
			 * <br/>
			 * The parameter <code>options</code> enables you to display buttons
			 * together with your message.<br/>
			 * The following snippet shows how you can populate an array with
			 * the necessary information:
			 * <pre>
			 *     var options = [
			 *         {
			 *             text: 'OK'
			 *             ,button: true
			 *             ,callback: function() { console.log('OK clicked'); }
			 *         },{
			 *             text: 'Cancel'
			 *             ,callback: function() { console.log('Cancel clicked'); }
			 *         }
			 *     ];
			 * </pre>
			 *
			 * Along with the passed message type and text, the user will see a button
			 * labled "OK" and a link "Cancel".<br/>
			 * As soon as the user clicks on one of them, the specific callback method
			 * will be called.
			 *
			 * @param type		[info, error, question]
			 * @param message	Messagetext
			 * @param options	An optional array with dictionary-items for each available option
			 * @access public
			 */
			self.addMessage = function(type, message, options) {
				var messageData = {
					type: type
					,message: message
					,options: options
				};
				messageQueue = new Array(messageData).concat(messageQueue);
			
				if($('.messagebox').size() == 0) self.displayQueuedMessage();
			}
		
			/**
			 * Checks the message queue for enqueued messages.<br/>
			 * If a message is available, it will be displayed.<br/>
			 * If more than one message is available, the oldest one gets displayed.
			 *
			 * @access public
			 */
			self.displayQueuedMessage = function() {
				var messageData = messageQueue.pop();
			
				if(messageData != undefined) {
					var messageBox = createMessageBox(messageData);
					$('.header-overall').after(messageBox);
					
					if(messageData.options == undefined || messageData.options.length == 0) {
						$(messageBox).slideDown(message_slidedown_time)
						.delay(message_show_time)
						.slideUp(message_slideup_time,function() {
							$(this).remove();
							self.displayQueuedMessage();
						});					
					} else {
						var overlay = createOverlay();
						$('body').append(overlay);
						overlay.fadeIn(overlay_fadein_time, function() {
							$(messageBox).slideDown(message_slidedown_time);
						});
					}

				}
			}
		
			/**
		     * Creates a messagebox DOM element with given parameters.
		     *
		     * @param messageData Dictionary with message data
			 * @see MessageController#addMessage(type,message,options)
			 * @access private
		     */
			function createMessageBox(messageData) {
		        var messagebox = $('<div class="messagebox" />');
		        var content = $('<div class="message ' + messageData.type + '">' + messageData.message + '</div>');
		        messagebox.append('<div class="barshadow">&nbsp;</div>');
		
		        if(messageData.options != undefined
					&& messageData.options.length > 0) {
					content.append(createOptions(messageData.options));
				}
		
		        messagebox.append(content);
		        messagebox.hide();
		        
		        return messagebox;
			}
			
			/**
			 * Creates clickable buttons and links from a options Information
			 * Array.
			 *
			 * @param options Array with information about the options
			 * @see MessageController#addMessage
			 * @see MessageController#createMessageBox
			 * @access private
			 */
			function createOptions(optionsData) {
				var container = $('<div class="options" />');
				
	        	for(var i = 0, l = optionsData.length; i < l; i++) {
					var text = optionsData[i]['text'];
	        		var showAsButton = optionsData[i]['button'];
					var callback = optionsData[i]['callback'];
					
					// The option:
	        		var class = ' class="option"';
					if(showAsButton) class = ' class="button"';
	        		var option = $('<a href="#"' + class + '>' + text + '</a>');
	        		
					// Eventbinding:
					// A click on an option makes the messagebox disappear in a first step.
					// After that, the callback of the option is called.
	        		$(option).bind('click', { callback : callback }, function(event) {
	        			$(this).parents('.messagebox').slideUp(message_slideup_time, function() {
							$(this).remove();
							
							$('.overlay').fadeOut(overlay_fadeout_time, function() {
		        				$(this).remove();
		        				if(event.data.callback != undefined) event.data.callback();
		        				self.displayQueuedMessage();
							});
	        			});
	        		});
	        		
	        		container.append(option);
	        	}
				
				return container;
			}
			
			/**
			 * Creates an overlay and returns it as jQuery DOM-Element.<br/>
			 * The overlay is used to mask the rest of the UI if a message has
			 * options to select (= modal dialog actually).
			 *
			 * @access private
			 */
			function createOverlay() {
				var overlay = $('<div class="overlay" />');
				overlay.hide();
				return overlay;
			}
			
			return self;
		}());  // end MessageController
	</script>
	
</body>
</html>